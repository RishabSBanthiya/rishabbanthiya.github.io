import{u as A,r as n,j as s}from"./index-421009aa.js";const M=({onClose:i})=>{const{theme:o}=A(),m=n.useRef(null),[h,k]=n.useState(0),[r,j]=n.useState(!1),[y,S]=n.useState({x:100,y:100}),[d,g]=n.useState(!1),[c,N]=n.useState({x:0,y:0}),p=n.useRef(null),E=n.useRef({paddle:{x:0,y:0,width:10,height:60,speed:8},ball:{x:0,y:0,dx:3,dy:3,radius:6},computer:{x:0,y:0,width:10,height:60,speed:4},keys:{up:!1,down:!1},animationId:0,canvas:{width:600,height:400}});n.useEffect(()=>{const l=m.current;if(!l)return;const a=l.getContext("2d");if(!a)return;const e=E.current;e.paddle.x=20,e.paddle.y=e.canvas.height/2-e.paddle.height/2,e.computer.x=e.canvas.width-30,e.computer.y=e.canvas.height/2-e.computer.height/2,e.ball.x=e.canvas.width/2,e.ball.y=e.canvas.height/2;const f=t=>{(t.key==="ArrowUp"||t.key==="w"||t.key==="W")&&(e.keys.up=!0,t.preventDefault()),(t.key==="ArrowDown"||t.key==="s"||t.key==="S")&&(e.keys.down=!0,t.preventDefault()),t.key==="Escape"&&i()},x=t=>{(t.key==="ArrowUp"||t.key==="w"||t.key==="W")&&(e.keys.up=!1),(t.key==="ArrowDown"||t.key==="s"||t.key==="S")&&(e.keys.down=!1)};document.addEventListener("keydown",f),document.addEventListener("keyup",x);const b=()=>{const t=o==="win95"?"#008080":"#1a1410",L=o==="win95"?"#808080":"#3d2f1f",R=o==="win95"?"#000080":"#d4a574",C=o==="win95"?"#ffffff":"#d4a574";a.fillStyle=t,a.fillRect(0,0,e.canvas.width,e.canvas.height),a.strokeStyle=L,a.lineWidth=2,a.setLineDash([10,10]),a.beginPath(),a.moveTo(e.canvas.width/2,0),a.lineTo(e.canvas.width/2,e.canvas.height),a.stroke(),a.setLineDash([]),e.keys.up&&e.paddle.y>0&&(e.paddle.y-=e.paddle.speed),e.keys.down&&e.paddle.y<e.canvas.height-e.paddle.height&&(e.paddle.y+=e.paddle.speed);const v=e.computer.y+e.computer.height/2,w=e.ball.y;if(v<w-10?e.computer.y+=e.computer.speed:v>w+10&&(e.computer.y-=e.computer.speed),e.computer.y<0&&(e.computer.y=0),e.computer.y>e.canvas.height-e.computer.height&&(e.computer.y=e.canvas.height-e.computer.height),e.ball.x+=e.ball.dx,e.ball.y+=e.ball.dy,(e.ball.y-e.ball.radius<=0||e.ball.y+e.ball.radius>=e.canvas.height)&&(e.ball.dy=-e.ball.dy),e.ball.x-e.ball.radius<=e.paddle.x+e.paddle.width&&e.ball.y>=e.paddle.y&&e.ball.y<=e.paddle.y+e.paddle.height&&e.ball.dx<0){e.ball.dx=-e.ball.dx*1.05;const u=(e.ball.y-e.paddle.y)/e.paddle.height;e.ball.dy=(u-.5)*8,k(P=>P+1)}if(e.ball.x+e.ball.radius>=e.computer.x&&e.ball.y>=e.computer.y&&e.ball.y<=e.computer.y+e.computer.height&&e.ball.dx>0){e.ball.dx=-e.ball.dx*1.05;const u=(e.ball.y-e.computer.y)/e.computer.height;e.ball.dy=(u-.5)*8}if(e.ball.x-e.ball.radius<=0){j(!0);return}e.ball.x+e.ball.radius>=e.canvas.width&&(e.ball.x=e.canvas.width/2,e.ball.y=e.canvas.height/2,e.ball.dx=-3,e.ball.dy=3),a.fillStyle=R,a.fillRect(e.paddle.x,e.paddle.y,e.paddle.width,e.paddle.height),a.fillRect(e.computer.x,e.computer.y,e.computer.width,e.computer.height),a.fillStyle=C,a.beginPath(),a.arc(e.ball.x,e.ball.y,e.ball.radius,0,Math.PI*2),a.fill(),r||(e.animationId=requestAnimationFrame(b))};return b(),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",x),e.animationId&&cancelAnimationFrame(e.animationId)}},[r,i,o]),n.useEffect(()=>{const l=e=>{d&&S({x:e.clientX-c.x,y:e.clientY-c.y})},a=()=>{g(!1)};return d&&(document.addEventListener("mousemove",l),document.addEventListener("mouseup",a)),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",a)}},[d,c]);const D=l=>{if(p.current&&p.current.contains(l.target)){const a=l.currentTarget.getBoundingClientRect();N({x:l.clientX-a.left,y:l.clientY-a.top}),g(!0)}};return s.jsx("div",{className:"pong-game-overlay",children:s.jsxs("div",{className:`pong-game-container ${d?"dragging":""}`,style:{transform:`translate(${y.x}px, ${y.y}px)`},onMouseDown:D,children:[s.jsxs("div",{className:"pong-game-header",ref:p,children:[s.jsxs("div",{className:"pong-terminal-buttons",children:[s.jsx("span",{className:"pong-terminal-button close",onClick:i}),s.jsx("span",{className:"pong-terminal-button minimize"}),s.jsx("span",{className:"pong-terminal-button maximize"})]}),s.jsx("h2",{children:"pong@terminal:~$"})]}),s.jsxs("div",{className:"pong-game-content",children:[s.jsxs("div",{className:"pong-info-bar",children:[s.jsxs("span",{className:"pong-score",children:["Score: ",h]}),s.jsx("span",{className:"pong-controls",children:"↑/↓ or W/S to move | ESC to quit"})]}),s.jsx("canvas",{ref:m,width:600,height:400,className:"pong-canvas"}),r&&s.jsxs("div",{className:"pong-game-over",children:[s.jsx("p",{className:"game-over-text",children:"Game Over!"}),s.jsxs("p",{className:"final-score",children:["Final Score: ",h]}),s.jsx("button",{onClick:i,className:"pong-close-btn",children:"Close (or press ESC)"})]})]})]})})};export{M as default};
