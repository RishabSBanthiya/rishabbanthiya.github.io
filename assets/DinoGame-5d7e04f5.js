import{u as q,r as a,j as i}from"./index-421009aa.js";const F=({onClose:u})=>{const{theme:r}=q(),b=a.useRef(null),[m,S]=a.useState(0),[h,Y]=a.useState(0),[g,k]=a.useState(!1),[N,M]=a.useState({x:150,y:150}),[f,R]=a.useState(!1),[y,T]=a.useState({x:0,y:0}),x=a.useRef(null),C=a.useRef({dino:{x:50,y:0,width:40,height:50,velocityY:0,jumping:!1,ducking:!1},obstacles:[],ground:{y:350},gravity:.6,jumpStrength:-12,gameSpeed:6,frameCount:0,score:0,keys:{space:!1,down:!1},animationId:0,canvas:{width:800,height:400}});a.useEffect(()=>{const s=b.current;if(!s)return;const t=s.getContext("2d");if(!t)return;const e=C.current;e.dino.y=e.ground.y-e.dino.height;const E=o=>{(o.key===" "||o.key==="ArrowUp")&&!e.dino.jumping&&(e.keys.space=!0,e.dino.jumping=!0,e.dino.velocityY=e.jumpStrength,o.preventDefault()),o.key==="ArrowDown"&&(e.keys.down=!0,e.dino.ducking=!0,o.preventDefault()),o.key==="Escape"&&u()},D=o=>{(o.key===" "||o.key==="ArrowUp")&&(e.keys.space=!1),o.key==="ArrowDown"&&(e.keys.down=!1,e.dino.ducking=!1)};document.addEventListener("keydown",E),document.addEventListener("keyup",D);const $=()=>{const o=Math.random()>.7?"bird":"cactus",p={x:e.canvas.width,width:o==="bird"?40:20,height:o==="bird"?30:40,type:o};e.obstacles.push(p)},L=()=>{e.frameCount++;const o=r==="win95"?"#008080":"#1a1410",p=r==="win95"?"#808080":"#3d2f1f",H=r==="win95"?"#000080":"#d4a574",I=r==="win95"?"#ffffff":"#1a1410",P=r==="win95"?"#ff0000":"#c17a6a",U=r==="win95"?"#000000":"#d4a574";t.fillStyle=o,t.fillRect(0,0,e.canvas.width,e.canvas.height),t.strokeStyle=p,t.lineWidth=2,t.beginPath(),t.moveTo(0,e.ground.y),t.lineTo(e.canvas.width,e.ground.y),t.stroke(),t.setLineDash([10,10]);for(let c=0;c<e.canvas.width;c+=20)t.beginPath(),t.moveTo(c-e.frameCount%20,e.ground.y+5),t.lineTo(c+10-e.frameCount%20,e.ground.y+5),t.stroke();t.setLineDash([]),e.dino.jumping&&(e.dino.velocityY+=e.gravity,e.dino.y+=e.dino.velocityY,e.dino.y>=e.ground.y-e.dino.height&&(e.dino.y=e.ground.y-e.dino.height,e.dino.jumping=!1,e.dino.velocityY=0));const v=e.dino.ducking?e.dino.height*.6:e.dino.height,w=e.dino.ducking?e.ground.y-v:e.dino.y;t.fillStyle=H,t.fillRect(e.dino.x,w,e.dino.width,v),t.fillStyle=I,t.fillRect(e.dino.x+5,w+5,5,5),e.frameCount%Math.max(80-Math.floor(e.score/100),40)===0&&$();for(let c=e.obstacles.length-1;c>=0;c--){const n=e.obstacles[c];if(n.x-=e.gameSpeed,n.x+n.width<0){e.obstacles.splice(c,1),e.score+=10,S(e.score);continue}if(t.fillStyle=P,n.type==="cactus")t.fillRect(n.x,e.ground.y-n.height,n.width,n.height),t.fillRect(n.x-5,e.ground.y-n.height+10,5,15),t.fillRect(n.x+n.width,e.ground.y-n.height+10,5,15);else{const j=e.ground.y-80;t.fillRect(n.x,j,n.width,n.height),t.fillRect(n.x-5,j+10,10,3),t.fillRect(n.x+n.width-5,j+10,10,3)}const d={x:e.dino.x+5,y:w+5,width:e.dino.width-10,height:v-10},G=n.type==="cactus"?e.ground.y-n.height:e.ground.y-80,l={x:n.x+5,y:G+5,width:n.width-10,height:n.height-10};if(d.x<l.x+l.width&&d.x+d.width>l.x&&d.y<l.y+l.height&&d.y+d.height>l.y){e.score>h&&Y(e.score),k(!0);return}}e.frameCount%100===0&&(e.gameSpeed+=.2),t.fillStyle=U,t.font='16px "Courier New"',t.fillText(`Score: ${e.score}`,10,30),t.fillText(`High: ${h}`,10,50),g||(e.animationId=requestAnimationFrame(L))};return L(),()=>{document.removeEventListener("keydown",E),document.removeEventListener("keyup",D),e.animationId&&cancelAnimationFrame(e.animationId)}},[g,h,u,r]);const A=()=>{k(!1),S(0);const s=C.current;s.obstacles=[],s.score=0,s.gameSpeed=6,s.frameCount=0};a.useEffect(()=>{const s=e=>{f&&M({x:e.clientX-y.x,y:e.clientY-y.y})},t=()=>{R(!1)};return f&&(document.addEventListener("mousemove",s),document.addEventListener("mouseup",t)),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",t)}},[f,y]);const O=s=>{if(x.current&&x.current.contains(s.target)){const t=s.currentTarget.getBoundingClientRect();T({x:s.clientX-t.left,y:s.clientY-t.top}),R(!0)}};return i.jsx("div",{className:"dino-game-overlay",children:i.jsxs("div",{className:`dino-game-container ${f?"dragging":""}`,style:{transform:`translate(${N.x}px, ${N.y}px)`},onMouseDown:O,children:[i.jsxs("div",{className:"dino-game-header",ref:x,children:[i.jsxs("div",{className:"dino-terminal-buttons",children:[i.jsx("span",{className:"dino-terminal-button close",onClick:u}),i.jsx("span",{className:"dino-terminal-button minimize"}),i.jsx("span",{className:"dino-terminal-button maximize"})]}),i.jsx("h2",{children:"dino@terminal:~$"})]}),i.jsxs("div",{className:"dino-game-content",children:[i.jsxs("div",{className:"dino-info-bar",children:[i.jsxs("span",{className:"dino-scores",children:["Score: ",m," | High: ",h]}),i.jsx("span",{className:"dino-controls",children:"SPACE/â†‘ jump | â†“ duck | ESC quit"})]}),i.jsx("canvas",{ref:b,width:800,height:400,className:"dino-canvas"}),g&&i.jsxs("div",{className:"dino-game-over",children:[i.jsx("p",{className:"game-over-text",children:"Game Over!"}),i.jsxs("p",{className:"final-score",children:["Score: ",m]}),m>0&&m===h&&i.jsx("p",{className:"new-high-score",children:"New High Score! ðŸŽ‰"}),i.jsxs("div",{className:"dino-buttons",children:[i.jsx("button",{onClick:A,className:"dino-restart-btn",children:"Restart"}),i.jsx("button",{onClick:u,className:"dino-close-btn",children:"Close (ESC)"})]})]})]})]})})};export{F as default};
